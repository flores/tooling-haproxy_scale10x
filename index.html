<head>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,600italic,700italic,300,400,800' rel='stylesheet' type='text/css'>
  <link href="https://raw.github.com/flores/impress.js/master/css/impress-demo.css" rel="stylesheet" />
  <script language="javascript" type="text/javascript" src="js/jit-yc.js"></script>
  <script language="javascript" type="text/javascript" src="js/cluster_diagram.js"></script>
  <style>
  #infovis {
    position:relative;
    width:1000px;
    height:700px;
    margin:auto;
    overflow:hidden;
    font-color: black;
    font-family: "Lucida Grande", Verdana;
    font-size: 0.5em;
    text-align: center;
    background-color: black;
  }
  #log {
    position:relative;
    top:10px;
    font-size:0em;
    font-weight:bold;
    color:#23A4FF;
  }
  #infovis-canvaswidget {
    margin:25px 0 0 25px;
  }
  #gist1 {
    width:800px;
    height:700px;
  }
  backend {
    font-size: 0.5em;
  }
  </style>
</head>

<body onload="init();">

  <div id="impress" class="impress-not-supported">

  <div class="fallback-message">
  </div>

  <div class="step" data-x="-2500" data-y="150">
  </div>
  
  <div class="step" data-x="-2160" data-y="150">
    <q>Carlo Flores</q>
  </div>

  <div class="step" data-x="-2070" data-y="225">
    <q>spire.io</q>
  </div>

  <div class="step" data-x="-2150" data-y="225">
    <q>lo@</q>
  </div>

  <div class="step" data-x="-2280" data-y="300">
    <q>meetup.com/LADevOps</q>
  </div>

  <div class="step" data-x="-2360" data-y="375">
    github.com/flores | @lolcatstevens
  </div>

  <div class="step" data-x="1100" data-y="-200" data-scale="5">
    We love HAProxy
  </div>

  <div class="step" data-x="-1000" data-y="300">
    <q>
    <strong>Really Fast, Configurable</strong>
    <ul>
    <li>epoll, kqueue</li>
    <li>event driven, single process</li>
    <li>pcre-based acls</li>
    <li>match on any header</li>
    <li>queues, frontends/backends, hot-spares, enable/disable servers...</li>
    </ul>
    </q>
  </div>


  <div class="step" data-x="0" data-y="300">
    <q>
    <strong>Mature</strong>
    <ul>
    <li>production since 2002 (v1.1)</li>
    <li>108000 http requests/sec</li>
    <li>claims to have never crashed (?!?)</li>
    <li>written by Willy Tarreau</li>
    </ul>
    </q>
  </div>

  <div class="step" data-x="1000" data-y="300">
    <img src="/img/happy-cuteness-overload-l.png">
  </div>

  <div class="step" data-x="0" data-y="1500">
    use case
  </div>
  
  <div class="step" data-x="-1000" data-y="4000" data-scale="5">
  
    <div id="log">
    </div>

    <div id="infovis">
    </div>

  </div>

  <div class="step" data-x="2900" data-y="2400">
    <q>
      that configuration
    </q>
  </div>

  <div class="step" data-x="3000" data-y="2800">
    <div id="gist1">
      <img src="/img/hairy_proxy.png">
    </div>
  </div>

  <div class="step" data-x="2900" data-y="3100">
    <q>
      gets hairy fast
    </q>
  </div>

  <div class="step" data-x="2900" data-y="3160">
    <q>
      enter <a href="https://github.com/joewilliams/haproxy_join">haproxy_join</a>
    </q>
  </div>
  
  <div class="step" data-x="2900" data-y="3220">
    <q>
      <a href="https://github.com/joewilliams">github.com/joewilliams</a>
    </q>
  </div>
  
  <div class="slide step" data-x="3500" data-y="2600">
    /etc/haproxy/conf/global.cfg
    <pre>
  global 
    log 127.0.0.1 local0 notice
    maxconn 50000
    daemon 
    stats socket /tmp/proxystats level admin
    </pre>
  </div>

  <div class="slide step" data-x="4500" data-y="2600">
    /etc/haproxy/conf/defaults.cfg
    <pre>
  defaults
    log global 
    mode http 
    option httplog 
    option dontlognull 
    stats enable 
    stats uri /proxystats   
    stats auth some:supersecretcredential
    stats refresh 5s 
    contimeout 120000
    clitimeout 120000
    srvtimeout 120000
    option redispatch
    option forwardfor
    option http-server-close
    </pre>
  </div>

  <div class="slide step" data-x="3500" data-y="3500">
    /etc/haproxy/conf/frontend.d/http.cfg
    <pre>
  frontend http
    bind :80
    acl rightfqdn hdr(host) www.ourdomain.com
    acl static url_reg (html|js|css|png|jpg|gif)$
    acl static url_beg /static
    acl api url_beg /api
    acl mobile  url_beg /mobile
    acl blog  url_beg /blog
    redirect location http://www.ourdomain.com if !rightfqdn
    use_backend static if static
    use_backend api if api
    use_backend mobile if mobile
    use_backend blog if blog
    default_backend static
  </pre>
  </div>

  <div class="slide step" data-x="4500" data-y="3500">
    /etc/haproxy/conf/backend.d/api.cfg
    <pre id="backend">
  backend api
    mode http
    balance leastconn
    monitor-uri /api_app_check
    server api1 10.10.30.1:80 check inter 60s rise 5 fall 2
    server api2 10.10.30.2:80 check inter 60s rise 5 fall 2
    server api3 10.10.30.3:80 check inter 60s rise 5 fall 2
    server api4 10.10.30.4:80 check inter 60s rise 5 fall 2
    server api5 10.10.30.5:80 check inter 60s rise 5 fall 2
    server api6 10.10.30.6:80 check inter 60s rise 5 fall 2
    server api7 10.10.30.7:80 check inter 60s rise 5 fall 2
    server api8 10.10.30.8:80 check inter 60s rise 5 fall 2
    server api9 10.10.30.9:80 check inter 60s rise 5 fall 2
    server api10 10.10.30.10:80 check inter 60s rise 5 fall 2
    ...
  </pre>
  </div>

  <div class="step" data-x="3500" data-y="4400">
    <pre>haproxy_join haproxy.cfg /etc/haproxy/</pre>
  </div>

  <div class="step" data-x="4500" data-y="4400">
    <q>
      worth noting there's a wonderful alternative at
      <a href='https://github.com/finnlabs/haproxy'>github.com/finnlabs/haproxy</a>
    </q>
  </div>

  <div class="step" data-x="-1000" data-y="6300" data-scale="2">
    Managing running instances    
  </div>

  <div class="step" data-x="-1600" data-y="6450">
    Fancy web UI
  </div>
    
  <div class="step" data-x="-1750" data-y="6700">
    <img src="/img/haproxy_webui.png">
  </div>

  <div class="step" data-x="-1750" data-y="7000">
    <ul>
    <li>Real time statistics</li>
    <li>ACL controlled for access restriction</li>
    <li>(dis|en)able individual servers</li>
    </ul>
  </div>

  <div class="step" data-x="-600" data-y="6450">
    UNIX socket
  </div>
  
  <div class="step" data-x="-750" data-y="6700">
    <img src="/img/stats_socket.png">
  </div>

  <div class="step" data-x="-750" data-y="7100">
    <ul>
    <li>same junk</li>
    <li>just really ugly</li>
    <li>hard to work with</li>
    <li>despite being on the cli</li>
    </ul>
  </div>

  <div class="step" data-x="750" data-y="6300">
    What I wanted: a ctl script for humans and programs
  </div>

  <div class="step" data-x="750" data-y="6450">
    enter haproxyctl
  </div>
  
  <div class="step" data-x="750" data-y="6600">
    <a href="http://github.com/flores/haproxyctl">github.com/flores/haproxyctl</a>
  </div>
  
  
  <div class="step" data-x="1250" data-y="6450">
    (dis|en)able a server from every backend it appears
  </div>
  
  <div class="step" data-x="1250" data-y="6600">
    (dis|en)able all servers <strong>except</strong> for a target server
  </div>
    
  <div class="step" data-x="1250" data-y="6750">
    Health checks for both programs and humans
  </div>

  </div>
  <script src="https://raw.github.com/flores/impress.js/master/js/impress.js"></script>
	



</body>
